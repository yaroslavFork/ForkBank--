<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ForkBank</title>
  <style>
    :root {
      --neon-green: #00ff88;
      --dark-bg: #020b0a;
    }

    body {
      background: var(--dark-bg);
      color: white;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      padding: 20px;
      margin: 0;
      overflow-x: hidden;
      /* –≠—Ñ—Ñ–µ–∫—Ç –°–µ–≤–µ—Ä–Ω–æ–≥–æ –°–∏—è–Ω–∏—è –Ω–∞ —Ñ–æ–Ω–µ */
      background: linear-gradient(135deg, #020b0a 0%, #05221a 50%, #020b0a 100%);
      background-size: 400% 400%;
      animation: auroraBackground 15s ease infinite;
    }

    @keyframes auroraBackground {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    .app-container {
      width: 100%;
      max-width: 400px;
      z-index: 10;
    }

    .card {
      background: rgba(10, 25, 20, 0.8);
      padding: 25px;
      border-radius: 25px;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.1);
      border: 1px solid rgba(0, 255, 136, 0.2);
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
    }

    input {
      width: 100%;
      padding: 14px;
      margin: 12px 0;
      border-radius: 12px;
      border: 1px solid var(--neon-green);
      background: rgba(0, 0, 0, 0.5);
      color: var(--neon-green);
      box-sizing: border-box;
      text-align: center;
      font-size: 16px;
      outline: none;
    }

    button {
      width: 100%;
      padding: 14px;
      margin: 8px 0;
      border-radius: 12px;
      background: transparent;
      color: var(--neon-green);
      border: 2px solid var(--neon-green);
      font-weight: bold;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1px;
      /* –≠—Ñ—Ñ–µ–∫—Ç –º–µ—Ä—Ü–∞–Ω–∏—è –∫–∞–∫ —Å–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ */
      animation: neonPulse 3s infinite alternate;
      transition: 0.3s;
    }

    @keyframes neonPulse {
      0% {
        box-shadow: 0 0 5px var(--neon-green), inset 0 0 2px var(--neon-green);
        border-color: #00cc6e;
      }

      100% {
        box-shadow: 0 0 15px var(--neon-green), inset 0 0 5px var(--neon-green);
        border-color: #00ff88;
      }
    }

    button:active {
      transform: scale(0.95);
      background: rgba(0, 255, 136, 0.1);
    }

    .balance-box {
      font-size: 48px;
      color: var(--neon-green);
      margin: 10px 0;
      font-weight: bold;
      text-shadow: 0 0 20px rgba(0, 255, 136, 0.6);
    }

    #admin-btn {
      position: fixed;
      bottom: 25px;
      right: 25px;
      background: var(--neon-green);
      color: black;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 24px;
      font-weight: bold;
      display: none;
      z-index: 1000;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 20px var(--neon-green);
    }

    .hidden {
      display: none !important;
    }

    .modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 85%;
      max-width: 350px;
      background: #020b0a;
      border: 2px solid var(--neon-green);
      border-radius: 30px;
      z-index: 2000;
      padding: 25px;
      text-align: center;
      box-shadow: 0 0 50px rgba(0, 255, 136, 0.3);
    }

    #overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1500;
      backdrop-filter: blur(5px);
    }

    .registry-box {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(0, 255, 136, 0.2);
      border-radius: 15px;
      margin: 20px 0;
      padding: 12px;
      max-height: 120px;
      overflow-y: auto;
      text-align: left;
    }

    .registry-item {
      font-size: 13px;
      color: #88ccaa;
      padding: 6px 0;
      border-bottom: 1px solid rgba(0, 255, 136, 0.1);
      display: flex;
      justify-content: space-between;
    }

    .status-vip {
      color: gold !important;
      text-shadow: 0 0 10px gold;
    }
  </style>
</head>

<body>

  <div class="app-container">
    <div id="screen-login" class="card">
      <h1 style="color:var(--neon-green); text-shadow: 0 0 10px var(--neon-green);">FORK BANK</h1>
      <p style="font-size:12px; color:#5a8a7a;">–°–ò–°–¢–ï–ú–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò</p>
      <input type="text" id="username" placeholder="–õ–û–ì–ò–ù">
      <input type="password" id="userpass" placeholder="–ü–ê–†–û–õ–¨">
      <button id="login-btn">–ü–û–î–ö–õ–Æ–ß–ò–¢–¨–°–Ø</button>
      <div id="login-status" style="color:var(--neon-green); font-size:11px; margin-top:8px; height: 15px;"></div>
    </div>

    <div id="screen-main" class="card hidden">
      <div id="user-info" style="color:#88ccaa; font-size: 14px; margin-bottom: 15px;"></div>
      <div class="balance-box"><span id="balance">0</span> D</div>

      <div style="margin-top:20px; background:rgba(0, 255, 136, 0.05); padding:15px; border-radius:20px; border:1px solid rgba(0,255,136,0.2);">
        <button id="click-btn" style="background:rgba(0, 255, 136, 0.1);">‚ö° –ú–ê–ô–ù–ò–ù–ì (+10 D)</button>
        <div id="piggy-val" style="color:var(--neon-green); font-size:24px; margin:8px; font-weight:bold;">0 D</div>
        <button id="withdraw-btn" style="border-color:#6f42c1; color:#b794f4; animation: none;">–í–´–í–ï–°–¢–ò –í –ë–ê–ù–ö</button>
      </div>

      <input type="text" id="promo-input" placeholder="–ü–†–û–ú–û–ö–û–î">
      <button id="apply-promo-btn" style="border-color:#00d9ff; color:#00d9ff; animation: none;">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨</button>

      <div class="card" style="border: 1px solid var(--neon-green); background: rgba(0,0,0,0.3); margin-top: 15px; padding: 15px;">
        <h4 style="margin:0 0 10px 0; color:var(--neon-green);">üé∞ –ö–ê–ó–ò–ù–û</h4>
        <div id="casino-anim" style="font-size:36px; margin:10px; font-weight:bold; color:var(--neon-green); text-shadow: 0 0 15px var(--neon-green);">1.0X</div>
        <input type="number" id="bet-amt" value="10">
        <button id="spin-btn" style="background:rgba(255, 75, 43, 0.1); border-color:#ff4b2b; color:#ff4b2b; animation: none;">–†–ò–°–ö–ù–£–¢–¨</button>
      </div>

      <div class="registry-box" id="ui-registry-list">...</div>

      <button id="send-btn" style="background:rgba(40, 167, 69, 0.1); border-color:#28a745; color:#28a745; animation: none;">üí∏ –ü–ï–†–ï–í–û–î –ü–û ID</button>
      <button id="access-btn" style="opacity:0; height:5px; margin:0;">.</button>
      <button id="logout-btn" style="border-color:#444; color:#666; font-size:10px; animation: none;">–í–´–•–û–î –ò–ó –°–ò–°–¢–ï–ú–´</button>
    </div>
  </div>

  <button id="admin-btn">–ü</button>

  <div id="modal-admin" class="modal">
    <h2 style="color:var(--neon-green); margin-bottom:20px; text-shadow: 0 0 10px var(--neon-green);">–£–ü–†–ê–í–õ–ï–ù–ò–ï</h2>
    <button id="adm-list-btn">üìä –†–ï–ï–°–¢–† –ë–ê–õ–ê–ù–°–û–í</button>
    <div id="admin-users-list" class="hidden" style="background:#000; border-radius:10px; padding:10px; max-height:150px; overflow-y:auto; text-align:left; font-size:11px; margin-bottom:10px; border: 1px solid var(--neon-green);"></div>
    <button id="adm-promo-btn">üéÅ –°–û–ó–î–ê–¢–¨ –ü–†–û–ú–û</button>
    <button id="adm-status-btn">üëë –ò–ó–ú–ï–ù–ò–¢–¨ –°–¢–ê–¢–£–°</button>
    <button id="adm-edit">üí∞ –ò–ó–ú–ï–ù–ò–¢–¨ –ë–ê–õ–ê–ù–°</button>
    <button id="adm-del-btn" style="border-color:#dc3545; color:#dc3545;">‚ùå –£–î–ê–õ–ò–¢–¨ –ê–ö–ö–ê–£–ù–¢</button>
    <button onclick="closeModals()" style="border-color:#666; color:#666; margin-top:15px; animation: none;">–ó–ê–ö–†–´–¢–¨</button>
  </div>
  <div id="overlay" onclick="closeModals()"></div>

  <script type="module">
    import {
      Client,
      Databases,
      ID,
      Query
    } from "https://cdn.jsdelivr.net/npm/appwrite@13.0.1/+esm";
    const client = new Client().setEndpoint('https://cloud.appwrite.io/v1').setProject('695f9aae003cc43e58d4');
    const databases = new Databases(client);
    const DB = '695f9bbc00302230a3eb',
      COL = 'users';
    const app = {
      user: null,
      allUsers: [],
      piggy: 0,
      lastActionTime: 0,
      async init() {
        window.closeModals = () => {
          document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
          document.getElementById('overlay').style.display = 'none';
        };
        document.getElementById('login-btn').onclick = () => this.login();
        document.getElementById('click-btn').onclick = () => {
          if (this.user.status !== 'banned') {
            this.piggy += 10;
            document.getElementById('piggy-val').innerText = this.piggy + " D";
          }
        };
        document.getElementById('withdraw-btn').onclick = () => this.withdrawPiggy();
        document.getElementById('apply-promo-btn').onclick = () => this.applyPromo();
        document.getElementById('spin-btn').onclick = () => this.playCasino();
        document.getElementById('send-btn').onclick = () => this.sendMoney();
        document.getElementById('access-btn').onclick = () => {
          if (prompt("–°–ï–ö–†–ï–¢–ù–´–ô –ö–û–î:") === "VYA_chsv") document.getElementById('admin-btn').style.display = 'block';
        };
        document.getElementById('admin-btn').onclick = () => {
          document.getElementById('modal-admin').style.display = 'block';
          document.getElementById('overlay').style.display = 'block';
        };
        document.getElementById('adm-list-btn').onclick = () => {
          const l = document.getElementById('admin-users-list');
          l.classList.toggle('hidden');
          l.innerHTML = this.allUsers.map(u => `<div style="padding:4px; border-bottom:1px solid #111;">ID:${u.user_id} | ${u.name} | ${u.balance}D</div>`).join('');
        };
        document.getElementById('adm-promo-btn').onclick = () => this.createPromo();
        document.getElementById('adm-status-btn').onclick = () => this.adminSetStatus();
        document.getElementById('adm-edit').onclick = () => this.adminEdit();
        document.getElementById('adm-del-btn').onclick = () => this.adminDelete();
        document.getElementById('logout-btn').onclick = () => {
          localStorage.clear();
          location.reload();
        };
        const saved = localStorage.getItem('fork_session');
        if (saved) {
          const {
            n,
            p
          } = JSON.parse(saved);
          this.login(n, p);
        }
      },
      async login(nIn, pIn) {
        const n = (nIn || document.getElementById('username').value).trim();
        const p = (pIn || document.getElementById('userpass').value).trim();
        const statusBox = document.getElementById('login-status');
        if (!n || !p) return;
        statusBox.innerText = "–ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø...";
        try {
          const res = await databases.listDocuments(DB, COL, [Query.equal("name", n)]);
          if (res.documents.length > 0) {
            const found = res.documents[0];
            if (found.passworld === p) {
              this.user = found;
              this.startApp(n, p);
            } else {
              statusBox.innerText = "–û–®–ò–ë–ö–ê –ü–ê–†–û–õ–Ø";
            }
          } else {
            statusBox.innerText = "–°–û–ó–î–ê–ù–ò–ï –ö–ê–ù–ê–õ–ê...";
            this.user = await databases.createDocument(DB, COL, ID.unique(), {
              name: n,
              passworld: p,
              balance: 100,
              user_id: Math.floor(Math.random() * 900) + 100,
              status: 'user'
            });
            this.startApp(n, p);
          }
        } catch (e) {
          statusBox.innerText = "–°–ë–û–ô –°–ï–¢–ò";
        }
      },
      startApp(n, p) {
        localStorage.setItem('fork_session', JSON.stringify({
          n,
          p
        }));
        document.getElementById('screen-login').classList.add('hidden');
        document.getElementById('screen-main').classList.remove('hidden');
        this.refreshData();
        setInterval(() => this.refreshData(), 8000);
      },
      async sync(newBal) {
        this.user.balance = Math.floor(newBal);
        document.getElementById('balance').innerText = this.user.balance;
        await databases.updateDocument(DB, COL, this.user.$id, {
          balance: this.user.balance
        });
      },
      async refreshData() {
        try {
          const res = await databases.listDocuments(DB, COL);
          this.allUsers = res.documents.filter(u => u.status !== 'promo');
          document.getElementById('ui-registry-list').innerHTML = this.allUsers.map(u => `<div class="registry-item">${u.name} <span>ID: ${u.user_id}</span></div>`).join('');
          const fresh = this.allUsers.find(u => u.$id === this.user.$id);
          if (fresh) {
            if (fresh.balance > this.user.balance) this.user.balance = fresh.balance;
            this.user.status = fresh.status;
            document.getElementById('balance').innerText = this.user.balance;
            document.getElementById('user-info').innerHTML = `<span class="${this.user.status==='vip'?'status-vip':''}">${this.user.status==='vip'?'üëë ':''}${this.user.name}</span> (ID: ${this.user.user_id})`;
          }
        } catch (e) {}
      },
      async playCasino() {
        const bet = parseInt(document.getElementById('bet-amt').value);
        if (!bet || bet > this.user.balance) return;
        const btn = document.getElementById('spin-btn');
        btn.disabled = true;
        const interval = setInterval(() => {
          document.getElementById('casino-anim').innerText = [0, 0.5, 1, 2, 5][Math.floor(Math.random() * 5)] + "X";
        }, 70);
        setTimeout(async () => {
          clearInterval(interval);
          const roll = Math.random();
          let res = roll < 0.3 ? 0 : roll < 0.5 ? 0.5 : roll < 0.8 ? 1 : roll < 0.95 ? 2 : 10;
          document.getElementById('casino-anim').innerText = res + "X";
          await this.sync((Number(this.user.balance) - bet) + Math.floor(bet * res));
          btn.disabled = false;
        }, 800);
      },
      async createPromo() {
        const c = prompt("–ö–û–î:");
        const v = prompt("–°–£–ú–ú–ê:");
        if (c && v) await databases.createDocument(DB, COL, ID.unique(), {
          name: "PROMO_" + c,
          passworld: "SYS",
          balance: parseInt(v),
          user_id: 0,
          status: 'promo'
        });
      },
      async applyPromo() {
        const input = document.getElementById('promo-input').value.trim();
        const res = await databases.listDocuments(DB, COL, [Query.equal("name", "PROMO_" + input)]);
        if (res.documents.length > 0) {
          const doc = res.documents[0];
          await databases.deleteDocument(DB, COL, doc.$id);
          await this.sync(Number(this.user.balance) + doc.balance);
          alert("–ë–û–ù–£–° –ó–ê–ß–ò–°–õ–ï–ù!");
          document.getElementById('promo-input').value = "";
        } else alert("–ö–û–î –ù–ï–ê–ö–¢–ò–í–ï–ù");
      },
      async withdrawPiggy() {
        if (!this.piggy) return;
        const amt = this.piggy;
        this.piggy = 0;
        document.getElementById('piggy-val').innerText = "0 D";
        await this.sync(Number(this.user.balance) + amt);
      },
      async adminSetStatus() {
        const id = prompt("ID:");
        const t = this.allUsers.find(u => u.user_id == id);
        if (t) {
          const s = prompt("1-USER, 2-VIP, 3-BAN");
          await databases.updateDocument(DB, COL, t.$id, {
            status: s === '2' ? 'vip' : s === '3' ? 'banned' : 'user'
          });
        }
      },
      async adminEdit() {
        const id = prompt("ID:");
        const v = parseInt(prompt("–°–£–ú–ú–ê (+/-):"));
        const t = this.allUsers.find(u => u.user_id == id);
        if (t) await databases.updateDocument(DB, COL, t.$id, {
          balance: t.balance + v
        });
      },
      async adminDelete() {
        const id = prompt("ID –ê–ö–ö–ê–£–ù–¢–ê:");
        const t = this.allUsers.find(u => u.user_id == id);
        if (t && confirm("–£–î–ê–õ–ò–¢–¨ –ò–ì–†–û–ö–ê?")) await databases.deleteDocument(DB, COL, t.$id);
      },
      async sendMoney() {
        const tid = prompt("ID –ü–û–õ–£–ß–ê–¢–ï–õ–Ø:");
        const amt = parseInt(prompt("–°–£–ú–ú–ê:"));
        const target = this.allUsers.find(u => u.user_id == tid);
        if (!target || amt > this.user.balance || amt <= 0) return alert("–û–®–ò–ë–ö–ê –ü–ï–†–ï–í–û–î–ê");
        await databases.updateDocument(DB, COL, this.user.$id, {
          balance: this.user.balance - amt
        });
        await databases.updateDocument(DB, COL, target.$id, {
          balance: target.balance + amt
        });
        await this.sync(this.user.balance - amt);
        alert("–ü–ï–†–ï–í–û–î –£–°–ü–ï–®–ï–ù");
      }
    };
    app.init();
  </script>
</body>

</html>
